<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Biblia Editable</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background-color: #f0f0f0;
      padding-bottom: 100px;
    }
    header {
      background-color: #0088cc;
      color: white;
      padding: 1rem;
      position: relative;
    }
    .google-login {
      position: absolute;
      top: 10px;
      right: 10px;
      z-index: 10;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    #userAvatar {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      display: none;
    }
    .verse-word {
      display: inline-block;
      margin: 2px;
      padding: 2px 6px;
      border-radius: 5px;
      cursor: pointer;
      background-color: #ffffff;
      transition: background-color 0.2s;
    }
    .verse-word:hover {
      background-color: #e0e0e0;
    }
    .verse-word.editing {
      background-color: #fffae6;
    }
    .restore-btn {
      font-size: 12px;
      margin-left: 10px;
      color: #007bff;
      cursor: pointer;
    }
    .restore-btn:hover {
      text-decoration: underline;
    }
    #saveCancelBar {
      position: fixed;
      bottom: 0;
      left: 0;
      width: 100%;
      background: #ffffff;
      border-top: 1px solid #ccc;
      display: none;
      justify-content: space-around;
      padding: 10px;
      z-index: 1000;
    }
    .top-buttons {
      display: flex;
      gap: 5px;
      flex-wrap: wrap;
      margin-bottom: 10px;
    }
    .top-buttons button {
      flex: 1 1 auto;
      font-size: 0.85rem;
      padding: 4px 8px;
    }
    .form-select {
      font-size: 0.85rem;
    }
  </style>
</head>
<body>
  <header>
    <h1>Biblia Editable</h1>
    <div class="google-login">
      <div id="googleSignInContainer">
        <div id="g_id_onload"
             data-client_id="87556669122-8vahjvva6kdvj3c8c5gvu09h2b1ve0p4.apps.googleusercontent.com"
             data-context="signin"
             data-ux_mode="popup"
             data-callback="onSignIn"
             data-auto_prompt="false"></div>

        <div class="g_id_signin"
             data-type="icon"
             data-size="medium"
             data-theme="filled_black"
             data-text="signin_with"
             data-shape="circle"
             data-logo_alignment="center"></div>
      </div>
      <img id="userAvatar" src="" alt="Avatar">
    </div>
  </header>

  <div class="container mt-3">
    <div class="top-buttons">
      <input type="text" id="searchInput" class="form-control" placeholder="Ej: Juan 3:16 o palabra clave...">
      <button class="btn btn-primary" onclick="buscarVersiculo()">Buscar</button>
      <button class="btn btn-success" onclick="restaurarVersiculo()">Restaurar vers√≠culo</button>
      <button class="btn btn-warning" onclick="reemplazoGlobal()">Reemplazo global</button>
    </div>

    <div class="row mb-3">
      <div class="col-6">
        <select id="libroSelect" class="form-select"></select>
      </div>
      <div class="col-6">
        <select id="capituloSelect" class="form-select"></select>
      </div>
    </div>

    <div id="topBar" class="d-flex gap-2 flex-wrap mb-3"></div>

    <div id="resultados" class="bg-white p-3 rounded shadow-sm"></div>
  </div>

  <div id="saveCancelBar" class="d-flex">
    <button class="btn btn-success" onclick="guardarCambios()">Guardar cambios</button>
    <button class="btn btn-secondary" onclick="cancelarCambios()">Cancelar</button>
  </div>

  <!-- Ventana flotante para notas -->
  <div id="notaFlotante" style="display:none; position:fixed; z-index:2000; background:#fff; border:2px solid #ccc; border-radius:10px; box-shadow:0 0 15px rgba(0,0,0,0.3); width:90%; max-width:500px; padding:0; font-family: 'Segoe UI', sans-serif;">
    <div id="notaHeader" style="padding:10px; background:#0088cc; color:#fff; cursor:move; border-top-left-radius:10px; border-top-right-radius:10px; font-weight:bold;">
      üìù Nota para: <span id="palabraActual"></span>
    </div>
    <div style="padding:15px;">
      <textarea id="notaInput" rows="10" class="form-control" style="width:100%; font-family:'Courier New', monospace;"></textarea>
    </div>
    <div style="display:flex; justify-content:flex-end; gap:10px; padding:10px;">
      <button id="cancelarNotaBtn" class="btn btn-secondary">Cancelar</button>
      <button id="guardarNotaBtn" class="btn btn-success">Guardar</button>
    </div>
  </div>

  <!-- Scripts -->
  <script src="https://accounts.google.com/gsi/client" async defer></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

  <script>
    let usuarioGoogle = null;

    function onSignIn(response) {
      const credential = response.credential;
      const payload = JSON.parse(atob(credential.split('.')[1]));
      usuarioGoogle = payload;
      alert(`Bienvenido ${payload.name}`);
      console.log("Usuario autenticado:", payload);

      // Mostrar avatar y ocultar el bot√≥n
      document.getElementById("userAvatar").src = payload.picture;
      document.getElementById("userAvatar").style.display = "inline-block";
      document.getElementById("googleSignInContainer").style.display = "none";
    }
  </script>
<script src="https://apis.google.com/js/api.js"></script>
<script src="drive.js"></script>
  <script src="app.js"></script>
  <script src="notas.js"></script>
</body>
</html>
